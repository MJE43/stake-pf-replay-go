{
  "meta": {
    "generated_at": "${ISO_8601}",
    "source": "static-analysis",
    "notes": "Inventory generated via code scan of backend/internal/api and internal/livehttp"
  },
  "surfaces": [
    {
      "group": "core-api",
      "protocol": "http",
      "base_path": "/",
      "routes": [
        {
          "method": "GET",
          "path": "/health",
          "operation": "healthCheck",
          "params": [],
          "auth": { "required": false },
          "permissions": { "model": "none" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 10, "p95_ms": 30, "source": "estimate", "reason": "simple system info aggregation" },
          "payload_p95_bytes": { "request": 0, "response": 2000, "source": "estimate" },
          "bulk": false,
          "relationships": [],
          "realtime": null,
          "notes": "Status + system info"
        },
        {
          "method": "GET",
          "path": "/health/ready",
          "operation": "readiness",
          "params": [],
          "auth": { "required": false },
          "permissions": { "model": "none" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 8, "p95_ms": 20, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 800, "source": "estimate" },
          "bulk": false,
          "relationships": [],
          "realtime": null,
          "notes": "Checks games + scanner presence"
        },
        {
          "method": "GET",
          "path": "/health/live",
          "operation": "liveness",
          "params": [],
          "auth": { "required": false },
          "permissions": { "model": "none" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 3, "p95_ms": 10, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 300, "source": "estimate" },
          "bulk": false,
          "relationships": [],
          "realtime": null,
          "notes": "Simple alive probe"
        },
        {
          "method": "GET",
          "path": "/metrics",
          "operation": "metrics",
          "params": [],
          "auth": { "required": false },
          "permissions": { "model": "none" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 10, "p95_ms": 40, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 4000, "source": "estimate" },
          "bulk": false,
          "relationships": [],
          "realtime": null,
          "notes": "Placeholder, returns system metrics map"
        },
        {
          "method": "GET",
          "path": "/games",
          "operation": "listGames",
          "params": [],
          "auth": { "required": false },
          "permissions": { "model": "none" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 5, "p95_ms": 15, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 5000, "source": "estimate" },
          "bulk": false,
          "relationships": ["games.GameSpec"],
          "realtime": null,
          "notes": "Mirrored under /api/v1/games"
        },
        {
          "method": "POST",
          "path": "/scan",
          "operation": "scan",
          "params": [
            { "name": "game", "in": "body", "type": "string", "required": true },
            { "name": "seeds.server", "in": "body", "type": "string", "required": true },
            { "name": "seeds.client", "in": "body", "type": "string", "required": true },
            { "name": "nonce_start", "in": "body", "type": "uint64", "required": true },
            { "name": "nonce_end", "in": "body", "type": "uint64", "required": true },
            { "name": "params", "in": "body", "type": "object", "required": false },
            { "name": "target_op", "in": "body", "type": "enum(eq|gt|ge|lt|le|between|outside)", "required": true },
            { "name": "target_val", "in": "body", "type": "float64", "required": true },
            { "name": "target_val2", "in": "body", "type": "float64", "required": false },
            { "name": "tolerance", "in": "body", "type": "float64", "required": false, "default": "1e-9 (0 for roulette)" },
            { "name": "limit", "in": "body", "type": "int", "required": false, "max": 100000 },
            { "name": "timeout_ms", "in": "body", "type": "int", "required": false, "max": 300000 }
          ],
          "auth": { "required": false },
          "permissions": { "model": "none" },
          "rate_limits": null,
          "idempotency": "none",
          "pagination": null,
          "filter_sort": null,
          "consistency": "deterministic-compute",
          "latency": {
            "p50_ms": 1000,
            "p95_ms": 5000,
            "source": "estimate",
            "reason": "Throughput from performance tests ~10k+ evals/sec; varies by nonce range and target"
          },
          "payload_p95_bytes": { "request": 700, "response": 100000, "source": "estimate", "reason": "hits array grows with limit" },
          "bulk": false,
          "relationships": ["scan.Summary", "scan.Hit"],
          "realtime": null,
          "notes": "Mirrored under /api/v1/scan; server enforces nonce range <= 10M and limit <= 100k"
        },
        {
          "method": "POST",
          "path": "/verify",
          "operation": "verifyNonce",
          "params": [
            { "name": "game", "in": "body", "type": "string", "required": true },
            { "name": "seeds.server", "in": "body", "type": "string", "required": true },
            { "name": "seeds.client", "in": "body", "type": "string", "required": true },
            { "name": "nonce", "in": "body", "type": "uint64", "required": true },
            { "name": "params", "in": "body", "type": "object", "required": false }
          ],
          "auth": { "required": false },
          "permissions": { "model": "none" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": null,
          "filter_sort": null,
          "consistency": "deterministic-compute",
          "latency": { "p50_ms": 5, "p95_ms": 20, "source": "estimate", "reason": "single evaluation" },
          "payload_p95_bytes": { "request": 300, "response": 1000, "source": "estimate" },
          "bulk": false,
          "relationships": ["games.GameResult"],
          "realtime": null,
          "notes": "Mirrored under /api/v1/verify"
        },
        {
          "method": "POST",
          "path": "/seed/hash",
          "operation": "seedHash",
          "params": [ { "name": "server_seed", "in": "body", "type": "string", "required": true } ],
          "auth": { "required": false },
          "permissions": { "model": "none" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": null,
          "filter_sort": null,
          "consistency": "pure-function",
          "latency": { "p50_ms": 1, "p95_ms": 2, "source": "estimate" },
          "payload_p95_bytes": { "request": 150, "response": 300, "source": "estimate" },
          "bulk": false,
          "relationships": [],
          "realtime": null,
          "notes": "Mirrored under /api/v1/seed/hash; logs hash, never stores seeds"
        }
      ]
    },
    {
      "group": "live-http",
      "protocol": "http",
      "base_path": "/live",
      "routes": [
        {
          "method": "POST",
          "path": "/live/ingest",
          "operation": "ingestBet",
          "params": [
            { "name": "X-Ingest-Token", "in": "header", "type": "string", "required": false },
            { "name": "id", "in": "body", "type": "string", "required": true },
            { "name": "dateTime", "in": "body", "type": "string(RFC3339)", "required": false },
            { "name": "nonce", "in": "body", "type": "int", "required": true, "min": 1 },
            { "name": "amount", "in": "body", "type": "float", "required": true },
            { "name": "payout", "in": "body", "type": "float", "required": true },
            { "name": "difficulty", "in": "body", "type": "enum(easy|medium|hard|expert)", "required": true },
            { "name": "roundTarget", "in": "body", "type": "float", "required": true },
            { "name": "roundResult", "in": "body", "type": "float", "required": true },
            { "name": "clientSeed", "in": "body", "type": "string", "required": true },
            { "name": "serverSeedHashed", "in": "body", "type": "string", "required": true }
          ],
          "auth": { "required": true, "scheme": "header-token", "header": "X-Ingest-Token" },
          "permissions": { "model": "single-tenant-local", "notes": "token optional; when set, required for ingest only" },
          "rate_limits": null,
          "idempotency": "idempotent(unique stream_id, antebot_bet_id)",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 8, "p95_ms": 25, "source": "estimate", "reason": "single INSERT + index updates" },
          "payload_p95_bytes": { "request": 500, "response": 200, "source": "estimate" },
          "bulk": false,
          "relationships": ["LiveStream", "LiveBet"],
          "realtime": { "channels": ["wails:live:newrows:{streamID}"], "delivery": "at-least-once", "trigger": "on accepted ingest" },
          "notes": "Creates/updates stream and inserts bet; emits Wails event"
        },
        {
          "method": "GET",
          "path": "/live/streams",
          "operation": "listStreams",
          "params": [
            { "name": "limit", "in": "query", "type": "int", "required": false, "default": 100, "max": 500 },
            { "name": "offset", "in": "query", "type": "int", "required": false, "default": 0 }
          ],
          "auth": { "required": false },
          "permissions": { "model": "single-tenant-local" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": { "type": "offset", "default": 100, "max": 500 },
          "filter_sort": { "filters": [], "sort": ["last_seen_at desc"] },
          "consistency": "strong-local",
          "latency": { "p50_ms": 6, "p95_ms": 20, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 25000, "source": "estimate" },
          "bulk": false,
          "relationships": ["LiveStream -> aggregates(total_bets, highest_result)"],
          "realtime": null,
          "notes": "Offset pagination; UI should use Load More, not auto infinite scroll"
        },
        {
          "method": "GET",
          "path": "/live/streams/{id}",
          "operation": "getStream",
          "params": [ { "name": "id", "in": "path", "type": "uuid", "required": true } ],
          "auth": { "required": false },
          "permissions": { "model": "single-tenant-local" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 3, "p95_ms": 10, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 600, "source": "estimate" },
          "bulk": false,
          "relationships": ["LiveStream"],
          "realtime": null,
          "notes": "Returns stream + aggregates"
        },
        {
          "method": "PUT",
          "path": "/live/streams/{id}",
          "operation": "updateStreamNotes",
          "params": [
            { "name": "id", "in": "path", "type": "uuid", "required": true },
            { "name": "notes", "in": "body", "type": "string", "required": true }
          ],
          "auth": { "required": false },
          "permissions": { "model": "single-tenant-local" },
          "rate_limits": null,
          "idempotency": "overwrite",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 4, "p95_ms": 12, "source": "estimate" },
          "payload_p95_bytes": { "request": 200, "response": 120, "source": "estimate" },
          "bulk": false,
          "relationships": ["LiveStream.notes"],
          "realtime": null,
          "notes": "Eligible for optimistic UI with rollback"
        },
        {
          "method": "DELETE",
          "path": "/live/streams/{id}",
          "operation": "deleteStream",
          "params": [ { "name": "id", "in": "path", "type": "uuid", "required": true } ],
          "auth": { "required": false },
          "permissions": { "model": "single-tenant-local" },
          "rate_limits": null,
          "idempotency": "idempotent(delete)",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 5, "p95_ms": 20, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 0, "source": "estimate" },
          "bulk": false,
          "relationships": ["LiveStream", "LiveBet (cascade)"],
          "realtime": null,
          "notes": "Deletes stream and bets"
        },
        {
          "method": "GET",
          "path": "/live/streams/{id}/bets",
          "operation": "listBets",
          "params": [
            { "name": "id", "in": "path", "type": "uuid", "required": true },
            { "name": "min_multiplier", "in": "query", "type": "float", "required": false, "default": 0 },
            { "name": "order", "in": "query", "type": "enum(nonce_asc|nonce_desc)", "required": false, "default": "nonce_asc" },
            { "name": "limit", "in": "query", "type": "int", "required": false, "default": 500, "max": 10000 },
            { "name": "offset", "in": "query", "type": "int", "required": false, "default": 0 }
          ],
          "auth": { "required": false },
          "permissions": { "model": "single-tenant-local" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": { "type": "offset", "default": 500, "max": 10000 },
          "filter_sort": { "filters": ["round_result >= min_multiplier"], "sort": ["nonce asc|desc"] },
          "consistency": "strong-local",
          "latency": { "p50_ms": 12, "p95_ms": 60, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 180000, "source": "estimate", "reason": "large page with 10k rows not recommended" },
          "bulk": false,
          "relationships": ["LiveBet -> LiveStream"],
          "realtime": { "channels": ["wails:live:newrows:{streamID}", "wails:live:status:{streamID}"], "usage": "tail for new" },
          "notes": "Use virtualization; prefer pageSize <= 500"
        },
        {
          "method": "GET",
          "path": "/live/streams/{id}/tail",
          "operation": "tailBets",
          "params": [
            { "name": "id", "in": "path", "type": "uuid", "required": true },
            { "name": "since_id", "in": "query", "type": "int64", "required": false, "default": 0 },
            { "name": "limit", "in": "query", "type": "int", "required": false, "default": 1000, "max": 5000 }
          ],
          "auth": { "required": false },
          "permissions": { "model": "single-tenant-local" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": { "type": "cursor(id)", "default": 1000, "max": 5000 },
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 8, "p95_ms": 30, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 120000, "source": "estimate" },
          "bulk": false,
          "relationships": ["LiveBet -> LiveStream"],
          "realtime": { "channels": ["wails:live:newrows:{streamID}"], "pattern": "event â†’ fetch tail" },
          "notes": "For live updates; append/prepend client-side"
        },
        {
          "method": "GET",
          "path": "/live/streams/{id}/export.csv",
          "operation": "exportCSV",
          "params": [ { "name": "id", "in": "path", "type": "uuid", "required": true } ],
          "auth": { "required": false },
          "permissions": { "model": "single-tenant-local" },
          "rate_limits": null,
          "idempotency": "safe",
          "pagination": null,
          "filter_sort": null,
          "consistency": "strong-local",
          "latency": { "p50_ms": 50, "p95_ms": 500, "source": "estimate" },
          "payload_p95_bytes": { "request": 0, "response": 5000000, "source": "estimate", "reason": "streamed CSV for large streams" },
          "bulk": true,
          "relationships": ["LiveBet -> LiveStream"],
          "realtime": null,
          "notes": "Streams CSV; client should stream download"
        }
      ]
    }
  ]
}

